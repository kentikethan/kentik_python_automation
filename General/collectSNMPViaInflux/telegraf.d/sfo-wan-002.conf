#==============================================================================
# Input Plugin - SNMP
#==============================================================================

[[inputs.snmp]]
  # A list of SNMP agent addresses to retrieve values from.
  # "udp://" is the protocol and "161" is the standard SNMP port.
  agents = ["udp://10.1.1.219:161"]
  name = "/system"

  # The SNMP protocol version to use. Options are 1, 2, or 3.
  version = 2

  # The SNMP community string for versions 1 and 2c.
  community = "kentik"

  # Timeout for each request.
  timeout = "5s"

  [inputs.snmp.tags]
      device_id = "273995"
      device_ip = "10.1.1.219"
      device_name = "sfo-wan-002"

 # Polling for individual system-level OIDs.
  [[inputs.snmp.field]]
    # OID for the device's uptime.
    oid = "SNMPv2-MIB::sysUpTime.0"
    name = "uptime-sec"

  [[inputs.snmp.field]]
    # OID for a textual description of the device.
    oid = "SNMPv2-MIB::sysDescr.0"
    name = "description"
    is_tag = true

  [[inputs.snmp.field]]
    # OID for the vendor/object ID, which can be used to determine the device type.
    oid = "SNMPv2-MIB::sysObjectID.0"
    name = "sys-object-id"
    is_tag = true

  [[inputs.snmp.field]]
    # OID for the vendor/object ID, which can be used to determine the device type.
    oid = "SNMPv2-MIB::sysLocation.0"
    name = "location"
    is_tag = true

  # Polling for SNMP infterface data
  [[inputs.snmp.table]]
    # The OID for the IF-MIB::ifTable.
    oid = "IF-MIB::ifTable"
    # A measurement name for the metrics from this table.
    name = "/interfaces/counters"
    # Inherit tags from the top-level SNMP plugin.
    inherit_tags = ["device_id", "device_ip", "device_name"]

    # Each field below corresponds to a column in the ifTable.
    # We define each one individually to ensure all relevant data is collected.

    # Interface Index (Tag) - This is a unique identifier for each interface on the device.
    [[inputs.snmp.table.field]]
      oid = "IF-MIB::ifIndex"
      name = "ifindex"
      is_tag = true

    # Interface Description (Tag) - A human-readable description of the interface.
    [[inputs.snmp.table.field]]
      oid = "IF-MIB::ifDescr"
      name = "ifDescr"
      is_tag = true

    [[inputs.snmp.table.field]]
      oid = "IF-MIB::ifAlias"
      name = "description"
      is_tag = true

    # Interface Type
    [[inputs.snmp.table.field]]
      oid = "IF-MIB::ifType"
      name = "type"
      is_tag = true

    # Maximum Transmission Unit
    [[inputs.snmp.table.field]]
      oid = "IF-MIB::ifMtu"
      name = "mtu"
      is_tag = true

    # Interface Speed
    [[inputs.snmp.table.field]]
      oid = "IF-MIB::ifSpeed"
      name = "speed"
      is_tag = true

    # Interface Mac Address
    [[inputs.snmp.table.field]]
      oid = "IF-MIB::ifPhysAddress"
      name = "mac-address"
      is_tag = true

    # Administrative Status of the interface
    [[inputs.snmp.table.field]]
      oid = "IF-MIB::ifAdminStatus"
      name = "admin-status"

    # Operational Status of the interface
    [[inputs.snmp.table.field]]
      oid = "IF-MIB::ifOperStatus"
      name = "oper-status"

    # Counter for octets (bytes) received on the interface.
    [[inputs.snmp.table.field]]
      oid = "IF-MIB::ifInOctets"
      name = "in-octets"

    # Counter for unicast packets received.
    [[inputs.snmp.table.field]]
      oid = "IF-MIB::ifInUcastPkts"
      name = "in-unicast-pkts"

    # Counter for non-unicast (multicast) packets received.
    [[inputs.snmp.table.field]]
      oid = "IF-MIB::ifInMulticastPkts"
      name = "in-multicast-pkts"

    # Counter for non-unicast (broadcast) packets received.
    [[inputs.snmp.table.field]]
      oid = "IF-MIB::ifInBroadcastPkts"
      name = "in-broadcast-pkts"

    # Counter for input errors on the interface.
    [[inputs.snmp.table.field]]
      oid = "IF-MIB::ifInErrors"
      name = "in-errors"

    # Counter for input discards on the interface.
    [[inputs.snmp.table.field]]
      oid = "IF-MIB::ifInDiscards"
      name = "in-discards"

    # Counter for octets (bytes) sent on the interface.
    [[inputs.snmp.table.field]]
      oid = "IF-MIB::ifOutOctets"
      name = "out-octets"

    # Counter for unicast packets sent.
    [[inputs.snmp.table.field]]
      oid = "IF-MIB::ifOutUcastPkts"
      name = "out-unicast-pkts"

    # Counter for non-unicast (multicast) packets sent.
    [[inputs.snmp.table.field]]
      oid = "IF-MIB::ifOutMulticastPkts"
      name = "out-multicast-pkts"

    # Counter for non-unicast (broadcast) packets sent.
    [[inputs.snmp.table.field]]
      oid = "IF-MIB::ifOutBroadcastPkts"
      name = "out-broadcast-pkts"

    # Counter for output errors on the interface.
    [[inputs.snmp.table.field]]
      oid = "IF-MIB::ifOutErrors"
      name = "out-errors"

    # Counter for outpu discards on the interface.
    [[inputs.snmp.table.field]]
      oid = "IF-MIB::ifInDiscards"
      name = "out-discards"


  # Polling for SNMP infterface IP Data
  [[inputs.snmp.table]]
    # The OID for the IF-MIB::ifTable.
    oid = "IP-MIB::ipAddrTable"
    # A measurement name for the metrics from this table.
    name = "/interfaces/subinterfaces/ipv4/addresses"
    # Inherit tags from the top-level SNMP plugin.
    inherit_tags = ["device_id", "device_ip", "device_name"]

    # Interface index for the IP address
    [[inputs.snmp.table.field]]
      oid = "IF-MIB::ipAdEntIfIndex"
      name = "ifindex"
      is_tag = true
    
    [[inputs.snmp.table.field]]
      oid = "IP-MIB::ipAdEntNetMask"
      name = "ip"
      is_tag = true
    
    [[inputs.snmp.table.field]]
      oid = "IP-MIB::ipAdEntNetMask"
      name = "netmask"
      is_tag = true

    [[inputs.snmp.table.field]]
      oid = "IP-MIB::ipAdEntReasmMaxSize"
      name = "ip-max-size"


